"use strict";(self.webpackChunkartiyoga=self.webpackChunkartiyoga||[]).push([[355],{9802:function(e,t,n){var a=n(7294),r=n(6492),c=n.n(r);t.Z=e=>{let{className:t,isBeingEdited:n,onChange:r,startContent:o,id:i,isInline:s,children:d}=e;let l,u;return n?l=o?c().decode(o):"":d?l=d:o&&(l=o?c().decode(o):""),u=t||"",n&&(u+=" index__card__content__description--is-being-edited"),s&&(u+=" index__card__content__description--is-inline"),a.createElement("div",{className:u,contentEditable:!!n,onInput:e=>{const t={};t[i]=e.currentTarget.textContent,r(t)},suppressContentEditableWarning:!0},l)}},3290:function(e,t,n){n.d(t,{X:function(){return d},a:function(){return s}});var a=n(7294),r=n(693),c=n(5258),o=n(144);const i=a.createContext([{},()=>{},{},()=>{},{},()=>{},{},()=>{}]),s=e=>{let{children:t}=e;const{0:n,1:r}=(0,a.useState)(void 0),{0:c,1:o}=(0,a.useState)(void 0),{0:s,1:d}=(0,a.useState)(void 0),{0:l,1:u}=(0,a.useState)(!1);return a.createElement(i.Provider,{value:[n,r,c,o,s,d,l,u]},t)},d=()=>{const{instance:e,accounts:t}=(0,c.Fp)(),{0:n,1:s,2:d,3:l,4:u,5:m,6:_,7:p}=(0,a.useContext)(i);return{projectGroupData:n,updateProjectGroupData:async n=>{try{const a=await(0,o.t)(t,e),c=await(0,r.Z)("projectgroups/"+n,"get",a,void 0);return s(c),c}catch(a){console.error("useProjectData:error:",a)}},userData:d,updateUserData:async n=>{try{const a=await(0,o.t)(t,e),c=await(0,r.Z)("users/role/?projectgroupname="+n,"get",a,void 0);return l(c),c}catch(a){console.error("useProjectData:updateUserData:error:",a)}},projectData:u,updateProjectData:async n=>{try{const a=await(0,o.t)(t,e);p(!1);let c=await(0,r.Z)("projects/projectgroups/"+n,"get",a,void 0);return m(c),p(!0),c}catch(a){console.error("useProjectData:updateProjectDataerror:",a)}},addOneProject:async n=>{try{const a=await(0,o.t)(t,e);return await(0,r.Z)("projects","post",a,{projectGroupName:n})}catch(a){console.error("useProjectData:addOneProject:error:",a)}},deleteOneProject:async n=>{try{const a=await(0,o.t)(t,e);return await(0,r.Z)("projects/"+n._id,"DELETE",a,void 0)}catch(a){console.error("useProjectData:deleteOneProject:error:",a)}},addMemberToProject:async n=>{try{const a=await(0,o.t)(t,e);return await(0,r.Z)("projects/"+n._id+"/member","POST",a,void 0)}catch(a){console.error("useProjectData:addMemberToProject:error:",a)}},deleteMemberFromProject:async n=>{try{const a=await(0,o.t)(t,e);return await(0,r.Z)("projects/"+n._id+"/member","DELETE",a,void 0)}catch(a){console.error("useProjectData:deleteMemberFromProject:error:",a)}},updateProject:async(n,a)=>{try{const c=await(0,o.t)(t,e);return await(0,r.Z)("projects/"+a,"PATCH",c,n)}catch(c){console.error("useProjectData:updateProject:error:",c)}},isLoaded:_,setIsLoaded:p}}},7008:function(e,t,n){var a=n(7294),r=n(4160);t.Z=e=>{let{children:t,name:n,...c}=e;const o=(0,r.useStaticQuery)("3028011774");if(n&&n.toLowerCase().includes("http://")||n&&n.toLowerCase().includes("https://"))return a.createElement("a",Object.assign({href:n},c),t);const i=o.allFile.edges.find((e=>e.node.base===n));return i?a.createElement("a",Object.assign({href:i.node.publicURL},c),t):a.createElement("div",null,a.createElement("h3",{style:{color:"red"}},"The file ",n," does not exist !"),t)}},9896:function(e,t,n){var a=n(7294),r=n(7814),c=n(1436);t.Z=()=>a.createElement("div",{className:"spinner"},a.createElement("div",{className:"spinner__overlay"}),a.createElement("div",{className:"spinner__animation"},a.createElement(r.G,{icon:c.LM3,className:"fa-3x fa-spin"})))},8329:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var a=n(7294),r=n(4160),c=n(5583),o=n(5772),i=n(3290),s=n(9256),d=(n(6492),n(7814)),l=n(1436),u=n(3405),m=n(9802);var _=e=>{let{project:t,setFilteredContents:n}=e;const{0:r,1:c}=(0,a.useState)(!1),{0:o,1:_}=(0,a.useState)(t.isPublic),{0:p,1:E}=(0,a.useState)({}),{deleteOneProject:j,updateProjectData:v,addMemberToProject:h,deleteMemberFromProject:g,updateProject:f,userData:b,projectGroupData:w,projectData:C}=(0,i.X)(),N=e=>{E((t=>({...t,...e})))};return t?a.createElement("div",{className:"index__card"+(r?" index__card--is-being-edited":""),key:t.shortId,id:t.shortId},a.createElement("div",{className:"index__card__header"},a.createElement("span",null,"Projet N° "+t.shortId+" : "),a.createElement(m.Z,{isBeingEdited:r,id:"name",onChange:N,startContent:t.name,isInline:!0})),a.createElement("div",{className:"index__card__description"},b.isAdmin&&a.createElement(d.G,{icon:l.I7k,onClick:async()=>{await j(t),await v(t.projectGroupName),n(void 0)}}),(b.isAdmin||t.projectMembers.includes(b.userName)&&"end"!==w.status)&&!r?a.createElement(d.G,{icon:l.Xcf,onClick:()=>{c(!0)}}):"","init"===w.status&&!C.find((e=>e.projectMembers.includes(b.userName)))&&t.projectMembers.length<w.maximumProjectMembers&&a.createElement(d.G,{icon:l.FKd,onClick:async()=>{await h(t);v&&(await v(t.projectGroupName),n(void 0))}}),"init"===w.status&&t.projectMembers.includes(b.userName)&&a.createElement(d.G,{icon:l.iC0,onClick:async()=>{await g(t);v&&(await v(t.projectGroupName),n(void 0))}}),r&&a.createElement(d.G,{icon:l.r6l,onClick:async()=>{if(p){const e=await f(p,t._id);E({}),c(!1),e&&(await v(t.projectGroupName),n(void 0))}}}),r&&a.createElement(d.G,{icon:l.NBC,onClick:()=>{c(!1),E({})}})),a.createElement("div",{className:"index__card__content"},void 0!==t.description?a.createElement(a.Fragment,null,a.createElement("div",{className:"index__card__content__title"},"Description"),a.createElement(m.Z,{className:"index__card__content__description",isBeingEdited:r,id:"description",startContent:t.description,onChange:N})):""),a.createElement("div",{className:"index__card__content"},void 0!==t.presentationUrl?a.createElement(a.Fragment,null,a.createElement("div",{className:"index__card__content__title"},"Vidéo de présentation"),a.createElement(m.Z,{className:"index__card__content__description",isBeingEdited:r,id:"presentationUrl",startContent:t.presentationUrl,onChange:N},a.createElement(s.Z,{src:t.presentationUrl}))):""),a.createElement("div",{className:"index__card__content"},void 0!==t.frontendProductionUrl?a.createElement(a.Fragment,null,a.createElement("div",{className:"index__card__content__title"},"URL du site"),a.createElement(m.Z,{className:"index__card__content__description",isBeingEdited:r,id:"frontendProductionUrl",startContent:t.frontendProductionUrl,onChange:N},a.createElement("a",{href:t.frontendProductionUrl,target:"_blank"},t.frontendProductionUrl))):""),a.createElement("div",{className:"index__card__content"},void 0!==t.frontendRepo?a.createElement(a.Fragment,null,a.createElement("div",{className:"index__card__content__title"},"Repo frontend"),a.createElement(m.Z,{className:"index__card__content__description",isBeingEdited:r,id:"frontendRepo",startContent:t.frontendRepo,onChange:N},a.createElement("a",{href:t.frontendRepo,target:"_blank"},t.frontendRepo))):""),a.createElement("div",{className:"index__card__content"},void 0!==t.backendRepo?a.createElement(a.Fragment,null,a.createElement("div",{className:"index__card__content__title"},"Repo backend"),a.createElement(m.Z,{className:"index__card__content__description",isBeingEdited:r,id:"backendRepo",startContent:t.backendRepo,onChange:N},a.createElement("a",{href:t.backendRepo,target:"_blank"},t.backendRepo))):""),a.createElement("div",{className:"index__card__content"},void 0!==t.projectMembers&&t.projectMembers.length>0?a.createElement(a.Fragment,null,a.createElement("div",{className:"index__card__content__title"},"Membres du projet"),a.createElement("div",{className:"index__card__content__description"},t.projectMembers.map((e=>(0,u.w)(e))).join(", "))):""),a.createElement("div",{className:"index__card__content"},void 0!==t.isPublic?a.createElement(a.Fragment,null,a.createElement("div",{className:"index__card__content__title"},"Public ?"),a.createElement("div",{className:"index__card__content__description"},a.createElement("input",{type:"checkbox",checked:o,disabled:!r,onClick:e=>{_(!o),E({...p,isPublic:!o})}}))):"")):null};var p=e=>{let{projects:t,setFilteredContents:n}=e;return!t||t.length<=0?null:a.createElement(a.Fragment,null,t.map((e=>a.createElement(_,{project:e,setFilteredContents:n}))))},E=n(9896),j=n(7008);var v=e=>{let{associatedProjectGroupName:t,projectDocument:n}=e;const{projectGroupData:r,updateProjectGroupData:c,userData:o,updateUserData:s,isLoaded:d,projectData:l,addOneProject:u,updateProjectData:m}=(0,i.X)(),{0:_,1:v}=(0,a.useState)(void 0),{0:h,1:g}=(0,a.useState)("");(0,a.useEffect)((()=>{f()}),[]);const f=async()=>{try{const e=await c(t);await s(t),await m(e._id)}catch(e){console.error("getData:error",e)}};return a.createElement(a.Fragment,null,!d&&a.createElement(E.Z,null),void 0===r?"":a.createElement("div",{className:"pl-3 pt-3 pb-3 pr-3"},a.createElement("h3",{className:""},"Projets des groupes de ",null==r?void 0:r._id),n&&a.createElement(j.Z,{name:n},"Consignes & template du projet"),a.createElement("div",{className:"index"},a.createElement("input",{type:"text","aria-label":"Search",placeholder:"Filtrez les contenus...",onChange:e=>{const t=e.target.value;g(e.target.value);const n=l.filter((e=>{const{shortId:n,name:a,description:r}=e;return a.toLowerCase().includes(t.toLowerCase())||r.toLowerCase().includes(t.toLowerCase())||t.length>0&&parseInt(t)===n}));n&&n.length>0?v(n):v(void 0)},className:"index__search"}),_&&_.length>0?a.createElement(p,{projects:_,setFilteredContents:v}):a.createElement(p,{projects:l,setFilteredContents:v})),void 0!==o&&o.isAdmin?a.createElement("button",{className:"index__button",onClick:async()=>{await u(r._id);await m(r._id);v(void 0)}},"Ajouter projet"):""))};var h=(0,o.O)((()=>{const e=(0,r.useStaticQuery)("641954533"),{defaultAssociatedProjectGroupName:t,projectDocument:n}=null==e?void 0:e.site.siteMetadata;return a.createElement(i.a,null,a.createElement(c.Z,null,a.createElement(v,{associatedProjectGroupName:t,projectDocument:n})))}))},693:function(e,t,n){async function a(e,t,n,a){void 0===t&&(t="get");let r=new Headers,c={};if(c.method=t,n){const e="Bearer "+n;r.append("Authorization",e)}a&&(c.body=JSON.stringify(a)),"post"!==t.toLowerCase()&&"patch"!==t.toLowerCase()&&"put"!==t.toLowerCase()||r.append("Content-Type","application/json"),c.headers=r;const o={}.GATSBY_API_URL+e;try{const e=await fetch(o,c);if(!e.ok){let t=" Error code : "+e.status+" : "+e.statusText+"/nMessage : ";throw t+=await e.text(),console.error("fetch() error",t),t.search("expired"),new Error(t)}return await e.json()}catch(i){throw i}}n.d(t,{Z:function(){return a}})},144:function(e,t,n){n.d(t,{t:function(){return r}});var a=n(3927);async function r(e,t){if(e.length>0){const r={scopes:["openid"],account:e[0]};try{return(await t.acquireTokenSilent(r)).idToken}catch(n){if(n instanceof a.Yo){return(await t.acquireTokenRedirect(r)).idToken}}}}},3405:function(e,t,n){n.d(t,{w:function(){return a}});const a=e=>{let t=e.substring(0,e.indexOf("@")),n=t.substring(0,t.indexOf(".")),a=t.substring(t.indexOf(".")+1);return n=n.charAt(0).toUpperCase()+n.slice(1),a=a.charAt(0).toUpperCase()+a.slice(1),a.indexOf(".")>=0&&(a=a.substring(a.indexOf(".")+1),a=a.charAt(0).toUpperCase()+a.slice(1)),n+" "+a}}}]);
//# sourceMappingURL=component---src-pages-project-page-js-01ad58a07a4608cf15ac.js.map